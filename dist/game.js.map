{"version":3,"sources":["SpaceControls.js","game.js","audio.js","controls.js","fog.js","lights.js","planet.js","ship.js","skybox.js"],"names":[],"mappings":"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IAAR,CAAa,UAAW,KAAX,EAAmB;AAC5C,MAAI,QAAJ,CAAa,CAAb,GAAkB,MAAM,cAAN,KAAyB,IAA1B,GAAkC,KAAlC,GAA0C,KAAK,EAA/C,GAAkD,CAAnE;AACH,CAFe,CAAhB;;AAIA,UAAU,KAAV;AC7EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACrEA,KAAK,MAAL,GAAc,KAAK,MAAL,CAAa;AACvB,UAAM,WADiB;AAEvB,eAAW,MAFY;AAGvB,aAAS,QAHc;AAIvB,YAAQ;AAJe,CAAb,CAAd","file":"game.js","sourcesContent":["/**\r\n * Â© Alexander Buzin, 2014-2015\r\n * Site: http://alexbuzin.me/\r\n * Email: alexbuzin88@gmail.com\r\n*/\r\n\r\n/**\r\n * First person controls.\r\n *\r\n * @param {Object} object - *WHS* figure/object.\r\n * @param {Object} params - Controls parameter objects.\r\n */\r\n\r\nconst PI_2 = Math.PI/2;\r\n\r\nWHS.World.prototype.SpaceControls = function( object, params = {} ) {\r\n\r\n    'use strict';\r\n\r\n    let target = WHS.API.extend(params, {\r\n        block: document.getElementById('blocker'),\r\n        speed: 1,\r\n        ypos: 1\r\n    });\r\n\r\n    this.controls = new (function ( camera, mesh, params) {\r\n\r\n        /* Velocity properties */\r\n        let velocityFactor = 1,\r\n            runVelocity = 0.25;\r\n\r\n        //mesh.setAngularFactor({x: 0, y: 0, z: 0});\r\n\r\n        /* Init */\r\n        let scope = this,\r\n            player = mesh,\r\n            pitchObject = new THREE.Object3D();\r\n\r\n        pitchObject.add( camera.getNative() );\r\n\r\n        let yawObject = new THREE.Object3D();\r\n\r\n        yawObject.position.y = params.ypos; // eyes are 2 meters above the ground\r\n        yawObject.add( pitchObject );\r\n\r\n        let quat = new THREE.Quaternion(),\r\n\r\n            moveForward = false,\r\n            moveBackward = false,\r\n            moveLeft = false,\r\n            moveRight = false,\r\n\r\n            canJump = false;\r\n\r\n        player.addEventListener(\"collision\", function(other_object, v, r, contactNormal){\r\n            if(contactNormal.y < 0.5) // Use a \"good\" threshold value between 0 and 1 here!\r\n                    canJump = true;\r\n        });\r\n\r\n        function onMouseMove ( event ) {\r\n            if ( scope.enabled === false ) return;\r\n\r\n            let movementX = event.movementX || event.mozMovementX || event.getMovementX() || 0,\r\n                movementY = event.movementY || event.mozMovementY || event.getMovementY() || 0;\r\n\r\n            yawObject.rotation.y -= movementX * 0.002,\r\n            pitchObject.rotation.x -= movementY * 0.002;\r\n\r\n            pitchObject.rotation.x = Math.max( - PI_2, Math.min( PI_2, pitchObject.rotation.x ) );\r\n        };\r\n\r\n        function onKeyDown ( event ) {\r\n\r\n            switch ( event.keyCode ) {\r\n\r\n                case 38: // up\r\n                case 87: // w\r\n                    moveForward = true;\r\n                    break;\r\n\r\n                case 37: // left\r\n                case 65: // a\r\n                    moveLeft = true;\r\n                    break;\r\n\r\n                case 40: // down\r\n                case 83: // s\r\n                    moveBackward = true;\r\n                    break;\r\n\r\n                case 39: // right\r\n                case 68: // d\r\n                    moveRight = true;\r\n                    break;\r\n\r\n                case 32: // space\r\n                    if ( canJump == true ){\r\n\r\n                            player.applyCentralImpulse({x: 0, y: 300, z: 0});\r\n\r\n                    }\r\n\r\n                    canJump = false;\r\n\r\n                    break;\r\n\r\n                case 16: // shift\r\n\r\n                        runVelocity = 0.5;\r\n                        break;\r\n\r\n            }\r\n\r\n        };\r\n\r\n        function onKeyUp ( event ) {\r\n            switch( event.keyCode ) {\r\n\r\n                case 38: // up\r\n                case 87: // w\r\n                    moveForward = false;\r\n                    break;\r\n\r\n                case 37: // left\r\n                case 65: // a\r\n                    moveLeft = false;\r\n                    break;\r\n\r\n                case 40: // down\r\n                case 83: // a\r\n                    moveBackward = false;\r\n                    break;\r\n\r\n                case 39: // right\r\n                case 68: // d\r\n                    moveRight = false;\r\n                    break;\r\n\r\n                case 16: // shift\r\n                    runVelocity = 0.25;\r\n                    break;\r\n\r\n            }\r\n\r\n        };\r\n\r\n        document.body.addEventListener( 'mousemove', onMouseMove, false );\r\n        document.body.addEventListener( 'keydown', onKeyDown, false );\r\n        document.body.addEventListener( 'keyup', onKeyUp, false );\r\n\r\n        this.enabled = false;\r\n\r\n        this.getObject = function () {\r\n            return yawObject;\r\n        };\r\n\r\n        this.getDirection = function(targetVec){\r\n            targetVec.set(0,0,-1);\r\n            quat.multiplyVector3(targetVec);\r\n        }\r\n\r\n        // Moves the camera to the Cannon.js object position\r\n        // and adds velocity to the object if the run key is down.\r\n        let inputVelocity = new THREE.Vector3(),\r\n            euler = new THREE.Euler();\r\n\r\n        this.update = function ( delta ) {\r\n\r\n            let moveVec = new THREE.Vector3();\r\n\r\n            if ( scope.enabled === false ) return;\r\n\r\n            delta = delta || 0.5;\r\n            delta = Math.min(delta, 0.5);\r\n\r\n            inputVelocity.set(0,0,0);\r\n\r\n            let speed = velocityFactor * delta * params.speed * runVelocity;\r\n\r\n            if ( moveForward ){\r\n                inputVelocity.z = -speed;\r\n            }\r\n\r\n            if ( moveBackward ){\r\n                inputVelocity.z = speed;\r\n            }\r\n\r\n            if ( moveLeft ){\r\n                inputVelocity.x = -speed;\r\n            }\r\n\r\n            if ( moveRight ){\r\n                inputVelocity.x = speed;\r\n            }\r\n\r\n            // Convert velocity to world coordinates\r\n            euler.x = pitchObject.rotation.x,\r\n            euler.y = yawObject.rotation.y,\r\n            euler.order = \"XYZ\";\r\n\r\n            quat.setFromEuler(euler);\r\n\r\n            inputVelocity.applyQuaternion(quat);\r\n\r\n            //player.applyCentralImpulse({x: inputVelocity.x * 10, y: 0, z: inputVelocity.z * 10});\r\n            player.setLinearVelocity({x: inputVelocity.z * 10, y: 0, z: -inputVelocity.x * 10});\r\n            player.setAngularFactor({x: 0, y: 0, z: 0});\r\n\r\n            yawObject.position.copy(player.position);\r\n        };\r\n\r\n    })(this.getCamera(), object.getNative(), target);\r\n\r\n    let controls = this.controls;\r\n\r\n    object.getNative().add( this.controls.getObject() );\r\n    console.log(object.getNative());\r\n\r\n    if ('pointerLockElement' in document ||\r\n        'mozPointerLockElement' in document ||\r\n        'webkitPointerLockElement' in document) {\r\n\r\n        var element = document.body;\r\n\r\n        this.pointerlockchange = function() {\r\n            if (document.pointerLockElement === element ||\r\n                document.mozPointerLockElement === element ||\r\n                document.webkitPointerLockElement === element) {\r\n\r\n                controls.enabled = true;\r\n\r\n                target.block.fadeOut();\r\n\r\n            } else {\r\n\r\n                controls.enabled = false;\r\n\r\n                target.block.fadeIn();\r\n\r\n            }\r\n\r\n        }\r\n\r\n    } else {\r\n\r\n        console.warn(\"Your browser does not support the PointerLock WHS.API.\");\r\n\r\n    }\r\n\r\n    document.addEventListener('pointerlockchange', this.pointerlockchange, false);\r\n    document.addEventListener('mozpointerlockchange', this.pointerlockchange, false);\r\n    document.addEventListener('webkitpointerlockchange', this.pointerlockchange, false);\r\n\r\n    this.pointerlockerror = function() {\r\n        console.warn(\"Pointer lock error.\");\r\n    }\r\n\r\n    document.addEventListener('pointerlockerror', this.pointerlockerror, false);\r\n    document.addEventListener('mozpointerlockerror', this.pointerlockerror, false);\r\n    document.addEventListener('webkitpointerlockerror', this.pointerlockerror, false);\r\n\r\n    target.block.addEventListener('click', function() {\r\n\r\n        element.requestPointerLock = element.requestPointerLock ||\r\n                                     element.mozRequestPointerLock ||\r\n                                     element.webkitRequestPointerLock;\r\n\r\n        element.requestFullscreen = element.requestFullscreen ||\r\n                                    element.mozRequestFullscreen ||\r\n                                    element.mozRequestFullScreen ||\r\n                                    element.webkitRequestFullscreen;\r\n\r\n        if (/Firefox/i.test(navigator.userAgent)) {\r\n\r\n            var fullscreenchange = function() {\r\n                if (document.fullscreenElement === element ||\r\n                    document.mozFullscreenElement === element ||\r\n                    document.mozFullScreenElement === element) {\r\n\r\n                        document.removeEventListener('fullscreenchange', fullscreenchange);\r\n                        document.removeEventListener('mozfullscreenchange', fullscreenchange);\r\n\r\n                        element.requestPointerLock();\r\n\r\n                }\r\n            }\r\n\r\n            document.addEventListener('fullscreenchange', fullscreenchange, false);\r\n            document.addEventListener('mozfullscreenchange', fullscreenchange, false);\r\n\r\n            element.requestFullscreen();\r\n\r\n        } else\r\n            element.requestPointerLock();\r\n\r\n    } );\r\n\r\n}\r\n","const preloader = Preloader();\r\n\r\nconst game = new WHS.World({\r\n  stats: false,\r\n  autoresize: true,\r\n\r\n  gravity: {\r\n    x: 0,\r\n    y: 0,\r\n    z: 0\r\n  },\r\n\r\n  camera: {\r\n    far: 10000,\r\n    aspect: 45\r\n  },\r\n\r\n  shadowmap: {\r\n      type: THREE.PCFShadowMap\r\n  },\r\n\r\n  rWidth: 1,\r\n  rHeight: 1,\r\n\r\n  background: 0x1E2F40,\r\n\r\n  path_worker: '../src/scripts/vendor/physijs_worker.js',\r\n\r\n  path_ammo: 'ammo.js'\r\n});\r\n\r\ngame.start();\r\n\r\nlet camera = game.getCamera();\r\n\r\npreloader.check();\r\n","const track = new THREE.AudioListener();\r\nconst soundtrack = new THREE.Audio(track);\r\nconst shipSound = new THREE.Audio(track);\r\nconst camera = game.getCamera();\r\nconst loader = new THREE.AudioLoader();\r\n\r\ncamera.add(track);\r\n\r\ngame.add(soundtrack);\r\n\r\nloader.load('assets/audio/365-days-in-space.ogg',\r\n function(audioBuffer){\r\n  soundtrack.setBuffer( audioBuffer );\r\n\tsoundtrack.play();\r\n}, function(xhr){}, function(xhr){console.log( 'An error happened' );});\r\n\r\nloader.load('assets/audio/flyby.ogg',\r\nfunction(audioBuffer){\r\n  shipSound.setBuffer(audioBuffer);\r\n  shipSound.loaded = true;\r\n}, function(xhr){}, function(xhr){console.log( 'An error happened' );});\r\n","\r\nconst spaceship = game.ConvexModel({\r\n  geometry:{\r\n    path: 'assets/models/spaceship.json',\r\n    physics: 'assets/models/spaceship_low.json'\r\n  },\r\n\r\n  material: {\r\n  },\r\n\r\n  mass: 100,\r\n\r\n  pos: {\r\n      x: 0,\r\n      y: 0,\r\n      z: 0\r\n  },\r\n\r\n  rotation: {\r\n      x: 0,\r\n      z: 0,\r\n      y: 0,\r\n  },\r\n\r\n  scale: {\r\n      x: 1,\r\n      y: 1,\r\n      z: 1\r\n  },\r\n});\r\n\r\n/*const camera = new WHS.PerspectiveCamera({\r\n    pos: {\r\n        x:0,\r\n        y:100,\r\n        z:0\r\n    }\r\n});\r\n\r\ngame.setCamera(camera);*/\r\n\r\n\r\nspaceship.addTo(game, \"wait\").then(function () {\r\n\r\n    //spaceship.add(camera);\r\n\r\n    game.SpaceControls( spaceship, { // *WHS* object, Pointer lock controls object, Jquery blocker div selector.\r\n        block: document.getElementById('blocker'),\r\n        speed: 1 // 5\r\n    } );\r\n\r\n})\r\n","const fog = game.FogExp2({\r\n  hex: 0x25424d,\r\n  near: 1,\r\n  far: 5\r\n});\r\n","let ambient = game.AmbientLight({\r\n  light: {\r\n    color: 0x83DCF9,\r\n    intensity: 0.2,\r\n\r\n    pos: {\r\n        x: 0,\r\n        y: 120,\r\n        z: 0,\r\n    },\r\n\r\n    target: {\r\n        x: 0,\r\n        y: 0,\r\n        z: 0\r\n    }\r\n  }\r\n});\r\n\r\nlet spot = game.SpotLight( {\r\n    light: {\r\n        color: 0x83DCF9,\r\n        intensity: 0.8,\r\n        distance: 500,\r\n    },\r\n\r\n    shadowmap: {\r\n        width: 2048,\r\n        height: 2048,\r\n        top: 0,\r\n        fov: 90\r\n    },\r\n\r\n    pos: {\r\n        x: 160, // 100,\r\n        y: 120, // 30,\r\n        z: 160, // 100\r\n    },\r\n\r\n    target: {\r\n        x: 0,\r\n        y: 0,\r\n        z: 0\r\n    }\r\n} );\r\n","let sunTexture = WHS.API.texture('assets/textures/sun.jpg');\r\nlet jupiterTexture = WHS.API.texture('assets/textures/jupiter.jpg');\r\nconst sun = game.Model({\r\n  geometry:{\r\n    path: 'assets/models/ik89123.json'\r\n  },\r\n\r\n  material: {\r\n    shading: THREE.SmoothShading,\r\n    map: sunTexture,\r\n    bunmap: sunTexture,\r\n    kind: 'phong',\r\n    wireframe:false,\r\n    vertexColors:false,\r\n    doubleSided:true,\r\n    depthWrite:true,\r\n    emissive: 0xffffff,\r\n    emissiveIntensity: 0.3\r\n  },\r\n\r\n  mass: 0,\r\n  pos: {\r\n      x: 500,\r\n      y: 500,\r\n      z: 500\r\n  },\r\n\r\n  scale: {\r\n      x: 50,\r\n      y: 50,\r\n      z: 50\r\n  },\r\n});\r\n\r\n\r\nlet jupiter = game.Model({\r\n  geometry:{\r\n    path: 'assets/models/ik89123.json'\r\n  },\r\n\r\n  material: {\r\n    shading: THREE.SmoothShading,\r\n    map: jupiterTexture,\r\n    bunmap: jupiterTexture,\r\n    kind: 'phong',\r\n    wireframe:false,\r\n    vertexColors:false,\r\n    doubleSided:true,\r\n    depthWrite:true,\r\n    emissive: 0xde9fa3,\r\n    emissiveIntensity: 0.3\r\n  },\r\n\r\n  mass: 0,\r\n  pos: {\r\n      x: 500,\r\n      y: 650,\r\n      z: 120\r\n  },\r\n\r\n  scale: {\r\n      x: 20,\r\n      y: 20,\r\n      z: 20\r\n  }\r\n});\r\n\r\n/*setInterval(function(){\r\n    var rot = sun.rotation;\r\n    sun.rotation.set(rot.x+=0.2, 0,0);\r\n    requestAnimationFrame();\r\n}, 500);*/\r\n\r\nvar updateSun = new WHS.loop(function ( clock ) {\r\n    sun.rotation.x = (clock.getElapsedTime() * 1000) / 10000 * Math.PI*2;\r\n});\r\n\r\nupdateSun.start();\r\n","/*const spaceship = game.Model({\r\n  geometry:{\r\n    path: 'assets/models/spaceship.json',\r\n    physics: 'assets/models/spaceship_low.json'\r\n  },\r\n\r\n  material: {\r\n  },\r\n\r\n  mass: 0,\r\n  pos: {\r\n      x: -1000,\r\n      y: -1000,\r\n      z: -1000\r\n  },\r\n\r\n  rotation: {\r\n      x: 0,\r\n      z: Math.PI / 4,\r\n      y: 0,\r\n  },\r\n\r\n  scale: {\r\n      x: 1,\r\n      y: 1,\r\n      z: 1\r\n  },\r\n});\r\nvar curve = new THREE.CurvePath();\r\ncurve.add(\r\n    new THREE.CubicBezierCurve3(\r\n        new THREE.Vector3( -1000, -1000, -1000),\r\n        new THREE.Vector3( -865, -650, -525 ),\r\n        new THREE.Vector3( -350, -350, -225 ),\r\n       new THREE.Vector3( -100, -100, -100 )\r\n    )\r\n);\r\ncurve.add(\r\n    new THREE.CubicBezierCurve3(\r\n        new THREE.Vector3( -100, -100, -100 ),\r\n        new THREE.Vector3( 0, 0, 0 ),\r\n        new THREE.Vector3( 25, 125, 0),\r\n        new THREE.Vector3( 200, 100, 350 )\r\n    )\r\n);\r\ncurve.add(\r\n    new THREE.CubicBezierCurve3(\r\n        new THREE.Vector3( 200, 100, 350 ),\r\n        new THREE.Vector3( 350, 250, 350 ),\r\n        new THREE.Vector3( 650, 750,  750 ),\r\n        new THREE.Vector3( 1000, 1000, 1000 )\r\n    )\r\n);\r\n\r\ncurve.add(\r\n    new THREE.CubicBezierCurve3(\r\n        new THREE.Vector3( 1000, 1000, 1000 ),\r\n        new THREE.Vector3( 1250, 1250, 3500 ),\r\n        new THREE.Vector3( 6500, 7500,  7500 ),\r\n        new THREE.Vector3( 10000, 10000, 10000 )\r\n    )\r\n);\r\n\r\n\r\nspaceship.addTo(game,'wait').then(function(obj){\r\n  obj.follow(curve,245000,false);\r\n  spaceship.add(shipSound);\r\n});\r\n*/","game.skybox = game.Skybox( {\r\n    path: \"img/space\",\r\n    imgSuffix: \".jpg\",\r\n    skyType: \"sphere\",\r\n    radius: 10000\r\n} );\r\n"],"sourceRoot":"/source/"}